FROM registry.access.redhat.com/ubi9/nginx-120

USER 0

# Limpa html padrão do nginx
RUN rm -rf /usr/share/nginx/html/*

# Copia build PRONTO (você já fez no host!)
COPY build/ /usr/share/nginx/html/

# Corrige permissões para nginx poder ler
RUN find /usr/share/nginx/html -type f -exec chmod 644 {} \; && \
    find /usr/share/nginx/html -type d -exec chmod 755 {} \;

# Copia nginx.conf customizado (se tiver)
COPY nginx.conf /etc/nginx/conf.d/default.conf

EXPOSE 8080

CMD ["nginx", "-g", "daemon off;"]
